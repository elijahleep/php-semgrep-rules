rules:
  - id: php-upload-source-filename
    languages: [php]
    severity: WARNING
    message: User-controlled filename used in upload path.

    metadata:
      owasp: ['A02:2021 – Cryptographic Failures']
      project: DVWA(2)

    pattern: |
      $X .= basename($_FILES[$F]['name']);



  - id: php-upload-sink-move
    languages: [php]
    severity: WARNING
    message: Uploaded file moved to a path.

    metadata:
      owasp: ['A02:2021 – Cryptographic Failures']
      project: DVWA(2)
    pattern: |
      move_uploaded_file($_FILES[$F]['tmp_name'], $Y)