{"version":"1.139.0","results":[{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":24,"col":5,"offset":755},"end":{"line":24,"col":54,"offset":804},"extra":{"metavars":{"$...VARS":{"start":{"line":24,"col":10,"offset":760},"end":{"line":24,"col":53,"offset":803},"abstract_content":"\"Username submitted: \".$username.\"<br>\""}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(\"Username submitted: \" . $username . \"<br>\");","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"a25f297e1e844b8cbc936cf7dff413db43dfa10ab2497f47bd3b2e073682659f514141f05d745f674e8f4dfdbec5aefb12a0aaaf180f8539b8845fe233d09526_0","lines":"    echo \"Username submitted: \" . $username . \"<br>\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":16,"col":17,"offset":521},"end":{"line":16,"col":23,"offset":527}},"$_POST"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":16,"col":5,"offset":509},"end":{"line":16,"col":14,"offset":518}},"content":"$username"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":24,"col":5,"offset":755},"end":{"line":24,"col":54,"offset":804}},"echo \"Username submitted: \" . $username . \"<br>\";"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":25,"col":5,"offset":810},"end":{"line":25,"col":48,"offset":853},"extra":{"metavars":{"$...VARS":{"start":{"line":25,"col":10,"offset":815},"end":{"line":25,"col":47,"offset":852},"abstract_content":"\"Email submitted: \".$email.\"<br>\""}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(\"Email submitted: \" . $email . \"<br>\");","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"d83bcff21398fadc0a93da8b5ce5d8e697881b59a0a8eef0a4a1d75f8575a8371b2f884b8eb19d107ae1763b5ff4c4a7ce188a42f4f9d6fc6368281bf4a33c32_0","lines":"    echo \"Email submitted: \" . $email . \"<br>\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":17,"col":14,"offset":555},"end":{"line":17,"col":20,"offset":561}},"$_POST"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":17,"col":5,"offset":546},"end":{"line":17,"col":11,"offset":552}},"content":"$email"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":25,"col":5,"offset":810},"end":{"line":25,"col":48,"offset":853}},"echo \"Email submitted: \" . $email . \"<br>\";"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":26,"col":5,"offset":859},"end":{"line":26,"col":55,"offset":909},"extra":{"metavars":{"$...VARS":{"start":{"line":26,"col":10,"offset":864},"end":{"line":26,"col":54,"offset":908},"abstract_content":"\"Phone number submitted: \".$phone.\"<br>\""}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(\"Phone number submitted: \" . $phone . \"<br>\");","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"5e9b9f08f6b0320eaa061fc9ce674c86842ac1e16ebfe8d72e5fa43bc03218c4cf031f6f29bd28d2b6780c64225f7c657f175d503f38501c22d90d000396a90d_0","lines":"    echo \"Phone number submitted: \" . $phone . \"<br>\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":18,"col":14,"offset":586},"end":{"line":18,"col":20,"offset":592}},"$_POST"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":18,"col":5,"offset":577},"end":{"line":18,"col":11,"offset":583}},"content":"$phone"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\secured.php","start":{"line":26,"col":5,"offset":859},"end":{"line":26,"col":55,"offset":909}},"echo \"Phone number submitted: \" . $phone . \"<br>\";"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":13,"col":5,"offset":406},"end":{"line":13,"col":54,"offset":455},"extra":{"metavars":{"$...VARS":{"start":{"line":13,"col":10,"offset":411},"end":{"line":13,"col":53,"offset":454},"abstract_content":"\"Username submitted: \".$username.\"<br>\""}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(\"Username submitted: \" . $username . \"<br>\");","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"3f1356484be92bbe6c3471837977a7b8170cec29a695703e4a35c930c09c1f5077102dbb0e33b4c308dc8e3d2a809970b7114945451e5e12306f5043d12bc893_0","lines":"    echo \"Username submitted: \" . $username . \"<br>\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":5,"col":17,"offset":172},"end":{"line":5,"col":23,"offset":178}},"$_POST"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":5,"col":5,"offset":160},"end":{"line":5,"col":14,"offset":169}},"content":"$username"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":13,"col":5,"offset":406},"end":{"line":13,"col":54,"offset":455}},"echo \"Username submitted: \" . $username . \"<br>\";"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":14,"col":5,"offset":461},"end":{"line":14,"col":48,"offset":504},"extra":{"metavars":{"$...VARS":{"start":{"line":14,"col":10,"offset":466},"end":{"line":14,"col":47,"offset":503},"abstract_content":"\"Email submitted: \".$email.\"<br>\""}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(\"Email submitted: \" . $email . \"<br>\");","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"59efbb6a9e153793e7800d64acbd659b34ce58b39cc3a437600f6556c78ef1279827b46a9618136cb08150949d27ee8abf2e33fc46d1e5652bd5c9fe940544bc_0","lines":"    echo \"Email submitted: \" . $email . \"<br>\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":6,"col":14,"offset":206},"end":{"line":6,"col":20,"offset":212}},"$_POST"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":6,"col":5,"offset":197},"end":{"line":6,"col":11,"offset":203}},"content":"$email"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":14,"col":5,"offset":461},"end":{"line":14,"col":48,"offset":504}},"echo \"Email submitted: \" . $email . \"<br>\";"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":15,"col":5,"offset":510},"end":{"line":15,"col":55,"offset":560},"extra":{"metavars":{"$...VARS":{"start":{"line":15,"col":10,"offset":515},"end":{"line":15,"col":54,"offset":559},"abstract_content":"\"Phone number submitted: \".$phone.\"<br>\""}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(\"Phone number submitted: \" . $phone . \"<br>\");","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"afc20c68de60fe36b38232a1755828ea143b60e2415bf034be9312f5ad2f09194226a91493c0a7ed03e66be63e695a7995736fdff4ab4f04f39941f8cbf7b635_0","lines":"    echo \"Phone number submitted: \" . $phone . \"<br>\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":7,"col":14,"offset":237},"end":{"line":7,"col":20,"offset":243}},"$_POST"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":7,"col":5,"offset":228},"end":{"line":7,"col":11,"offset":234}},"content":"$phone"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\CSRF\\vulnerable.php","start":{"line":15,"col":5,"offset":510},"end":{"line":15,"col":55,"offset":560}},"echo \"Phone number submitted: \" . $phone . \"<br>\";"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.weak-crypto","path":"CodeAlpha_Task_3\\Cookie_Hijacking\\secured.php","start":{"line":45,"col":12,"offset":2072},"end":{"line":45,"col":41,"offset":2101},"extra":{"metavars":{},"message":"Detected usage of weak crypto function. Consider using stronger alternatives.","metadata":{"cwe":["CWE-328: Use of Weak Hash"],"references":["https://www.php.net/manual/en/book.sodium.php","https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/CryptoFunctionsSniff.php"],"category":"security","technology":["php"],"owasp":["A03:2017 - Sensitive Data Exposure","A02:2021 - Cryptographic Failures"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW"},"severity":"ERROR","fingerprint":"da8d292756acad37fb60b203df985429864b566f3beb74fb98a363391177fde6c9a9aa031a3aaa5e1bfd6ee889f8a85b6decaa1c95f49a6768ec0ebc4cead8d9_0","lines":"    return md5($username . $random_data);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.weak-crypto","path":"CodeAlpha_Task_3\\Cookie_Hijacking\\vulnerable.php","start":{"line":16,"col":26,"offset":490},"end":{"line":16,"col":40,"offset":504},"extra":{"metavars":{},"message":"Detected usage of weak crypto function. Consider using stronger alternatives.","metadata":{"cwe":["CWE-328: Use of Weak Hash"],"references":["https://www.php.net/manual/en/book.sodium.php","https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/CryptoFunctionsSniff.php"],"category":"security","technology":["php"],"owasp":["A03:2017 - Sensitive Data Exposure","A02:2021 - Cryptographic Failures"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW"},"severity":"ERROR","fingerprint":"977a7ac3ab650ad1704db62c918e49ea86e0c7aea97a3f348e4b50deea7acbc37d5e1a93fb726be0625d4b3c46c798ba96834df18d0c0ce8eff3236d1657a9da_0","lines":"        $session_token = md5($username);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.tainted-sql-string","path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":31,"col":8,"offset":800},"end":{"line":31,"col":49,"offset":841},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":7,"offset":6},"abstract_content":"SELECT"},"$EXPR":{"start":{"line":31,"col":9,"offset":801},"end":{"line":31,"col":40,"offset":832},"abstract_content":"SELECT * FROM users WHERE id = "}},"message":"User data flows into this manually-constructed SQL string. User data can be safely inserted into SQL strings using prepared statements or an object-relational mapper (ORM). Manually-constructed SQL strings is a possible indicator of SQL injection, which could let an attacker steal or manipulate data from the database. Instead, use prepared statements (`$mysqli->prepare(\"INSERT INTO test(id, label) VALUES (?, ?)\");`) or a safe library.","metadata":{"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://owasp.org/www-community/attacks/SQL_Injection"],"category":"security","technology":["php"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"a597e92a01af331db6f03b425045f8bab58c9fcd170450bf993adf8789b508a345058c61533a7bf22df9ba5119e116469f646c55ac72d34b901358a0e1fef0c9_0","lines":"$sql = \"SELECT * FROM users WHERE id = $user_id\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":23,"col":12,"offset":551},"end":{"line":23,"col":17,"offset":556}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":23,"col":1,"offset":540},"end":{"line":23,"col":9,"offset":548}},"content":"$user_id"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":23,"col":1,"offset":540},"end":{"line":23,"col":9,"offset":548}},"content":"$user_id"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":31,"col":8,"offset":800},"end":{"line":31,"col":49,"offset":841}},"\"SELECT * FROM users WHERE id = $user_id\""]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":37,"col":5,"offset":979},"end":{"line":37,"col":51,"offset":1025},"extra":{"metavars":{"$...VARS":{"start":{"line":37,"col":10,"offset":984},"end":{"line":37,"col":50,"offset":1024},"abstract_content":"\"Username: \".$row['username'].\"<br>\""}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(\"Username: \" . $row['username'] . \"<br>\");","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"573814b81d6b5fdcdb5b4160d7540e9bcd7509f300089dea794f0447439e01e0a9720a34548030a509f2cf75d3bc1ae26b54503bf65d50ebec49cf8e20694ac8_0","lines":"    echo \"Username: \" . $row['username'] . \"<br>\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":23,"col":12,"offset":551},"end":{"line":23,"col":17,"offset":556}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":23,"col":1,"offset":540},"end":{"line":23,"col":9,"offset":548}},"content":"$user_id"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":31,"col":8,"offset":800},"end":{"line":31,"col":9,"offset":801}},"content":"\""},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":31,"col":1,"offset":793},"end":{"line":31,"col":5,"offset":797}},"content":"$sql"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":32,"col":1,"offset":844},"end":{"line":32,"col":8,"offset":851}},"content":"$result"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":35,"col":5,"offset":911},"end":{"line":35,"col":9,"offset":915}},"content":"$row"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":37,"col":5,"offset":979},"end":{"line":37,"col":51,"offset":1025}},"echo \"Username: \" . $row['username'] . \"<br>\";"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":38,"col":5,"offset":1031},"end":{"line":38,"col":45,"offset":1071},"extra":{"metavars":{"$...VARS":{"start":{"line":38,"col":10,"offset":1036},"end":{"line":38,"col":44,"offset":1070},"abstract_content":"\"Email: \".$row['email'].\"<br>\""}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(\"Email: \" . $row['email'] . \"<br>\");","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"9219c17053854703dc9342e0f982cc4c663e55525c6060c7af58fd3de2891f54b30405edd5bafc97f1a15e5ab19a0d86a18e48708eb670893740bd610dfa8e00_0","lines":"    echo \"Email: \" . $row['email'] . \"<br>\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":23,"col":12,"offset":551},"end":{"line":23,"col":17,"offset":556}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":23,"col":1,"offset":540},"end":{"line":23,"col":9,"offset":548}},"content":"$user_id"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":31,"col":8,"offset":800},"end":{"line":31,"col":9,"offset":801}},"content":"\""},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":31,"col":1,"offset":793},"end":{"line":31,"col":5,"offset":797}},"content":"$sql"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":32,"col":1,"offset":844},"end":{"line":32,"col":8,"offset":851}},"content":"$result"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":35,"col":5,"offset":911},"end":{"line":35,"col":9,"offset":915}},"content":"$row"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","start":{"line":38,"col":5,"offset":1031},"end":{"line":38,"col":45,"offset":1071}},"echo \"Email: \" . $row['email'] . \"<br>\";"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.tainted-sql-string","path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":19,"col":8,"offset":448},"end":{"line":19,"col":49,"offset":489},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":7,"offset":6},"abstract_content":"SELECT"},"$EXPR":{"start":{"line":19,"col":9,"offset":449},"end":{"line":19,"col":40,"offset":480},"abstract_content":"SELECT * FROM users WHERE id = "}},"message":"User data flows into this manually-constructed SQL string. User data can be safely inserted into SQL strings using prepared statements or an object-relational mapper (ORM). Manually-constructed SQL strings is a possible indicator of SQL injection, which could let an attacker steal or manipulate data from the database. Instead, use prepared statements (`$mysqli->prepare(\"INSERT INTO test(id, label) VALUES (?, ?)\");`) or a safe library.","metadata":{"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://owasp.org/www-community/attacks/SQL_Injection"],"category":"security","technology":["php"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"babd5f24bb7fab9ed4cf38c262b7b5c5ba4821a103e8165bf0173deb5e464459e6a3442dc8dae922f94ba72bb2bbad871980ca9d5e1aadfe8b1ddc275a9625a5_0","lines":"$sql = \"SELECT * FROM users WHERE id = $user_id\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":16,"col":12,"offset":380},"end":{"line":16,"col":17,"offset":385}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":16,"col":1,"offset":369},"end":{"line":16,"col":9,"offset":377}},"content":"$user_id"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":16,"col":1,"offset":369},"end":{"line":16,"col":9,"offset":377}},"content":"$user_id"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":19,"col":8,"offset":448},"end":{"line":19,"col":49,"offset":489}},"\"SELECT * FROM users WHERE id = $user_id\""]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":25,"col":5,"offset":627},"end":{"line":25,"col":51,"offset":673},"extra":{"metavars":{"$...VARS":{"start":{"line":25,"col":10,"offset":632},"end":{"line":25,"col":50,"offset":672},"abstract_content":"\"Username: \".$row['username'].\"<br>\""}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(\"Username: \" . $row['username'] . \"<br>\");","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"75c94bb057cbbee5e74002c11b160a0eb9ab3feb7ee42e36c9f6034fff17dd205497d07c7a53750f7bab07d4354b49b0fdf70dfaca07e8f88a0fef93e1b1adda_0","lines":"    echo \"Username: \" . $row['username'] . \"<br>\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":16,"col":12,"offset":380},"end":{"line":16,"col":17,"offset":385}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":16,"col":1,"offset":369},"end":{"line":16,"col":9,"offset":377}},"content":"$user_id"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":19,"col":8,"offset":448},"end":{"line":19,"col":9,"offset":449}},"content":"\""},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":19,"col":1,"offset":441},"end":{"line":19,"col":5,"offset":445}},"content":"$sql"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":20,"col":1,"offset":492},"end":{"line":20,"col":8,"offset":499}},"content":"$result"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":23,"col":5,"offset":559},"end":{"line":23,"col":9,"offset":563}},"content":"$row"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":25,"col":5,"offset":627},"end":{"line":25,"col":51,"offset":673}},"echo \"Username: \" . $row['username'] . \"<br>\";"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":26,"col":5,"offset":679},"end":{"line":26,"col":45,"offset":719},"extra":{"metavars":{"$...VARS":{"start":{"line":26,"col":10,"offset":684},"end":{"line":26,"col":44,"offset":718},"abstract_content":"\"Email: \".$row['email'].\"<br>\""}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(\"Email: \" . $row['email'] . \"<br>\");","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"0a637646e72048c8d1ef821dc9d1c79d5fa1127b91dc9e793fa14999cc6311b17e35e0e240dd1502100d635e1431497edaad7f88619d20406d6d9e30ef83e541_0","lines":"    echo \"Email: \" . $row['email'] . \"<br>\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":16,"col":12,"offset":380},"end":{"line":16,"col":17,"offset":385}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":16,"col":1,"offset":369},"end":{"line":16,"col":9,"offset":377}},"content":"$user_id"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":19,"col":8,"offset":448},"end":{"line":19,"col":9,"offset":449}},"content":"\""},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":19,"col":1,"offset":441},"end":{"line":19,"col":5,"offset":445}},"content":"$sql"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":20,"col":1,"offset":492},"end":{"line":20,"col":8,"offset":499}},"content":"$result"},{"location":{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":23,"col":5,"offset":559},"end":{"line":23,"col":9,"offset":563}},"content":"$row"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","start":{"line":26,"col":5,"offset":679},"end":{"line":26,"col":45,"offset":719}},"echo \"Email: \" . $row['email'] . \"<br>\";"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":21,"col":5,"offset":527},"end":{"line":21,"col":47,"offset":569},"extra":{"metavars":{"$...VARS":{"start":{"line":21,"col":10,"offset":532},"end":{"line":21,"col":46,"offset":568},"abstract_content":"file_get_contents('./'.$page.'.php')"}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(file_get_contents('./'.$page.'.php'));","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"317aae3f98d119b244d79042076c0b40a4b7b3ac6c506270c7dbbcb89a17682da5a64d9a0c1f33bb6e35247d7767e0743bfeab026f515452953d7033e900d233_0","lines":"    echo file_get_contents('./'.$page.'.php');","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":13,"col":17,"offset":345},"end":{"line":13,"col":22,"offset":350}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":13,"col":9,"offset":337},"end":{"line":13,"col":14,"offset":342}},"content":"$page"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":21,"col":5,"offset":527},"end":{"line":21,"col":47,"offset":569}},"echo file_get_contents('./'.$page.'.php');"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.tainted-filename","path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":21,"col":28,"offset":550},"end":{"line":21,"col":45,"offset":567},"extra":{"metavars":{"$FILENAME":{"start":{"line":21,"col":28,"offset":550},"end":{"line":21,"col":45,"offset":567},"abstract_content":"'./'.$page.'.php'"}},"message":"File name based on user input risks server-side request forgery.","metadata":{"technology":["php"],"category":"security","cwe":["CWE-918: Server-Side Request Forgery (SSRF)"],"owasp":["A10:2021 - Server-Side Request Forgery (SSRF)"],"references":["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"impact":"MEDIUM","likelihood":"MEDIUM","confidence":"MEDIUM"},"severity":"WARNING","fingerprint":"3f16813805a322a5d4eae4112ebd317381b1ff2f395d565c3aefc12943431367e3ba1bd6e0147b72aa2884158b2851fc3035dc98bae28c42d584ee64d1882ec1_0","lines":"    echo file_get_contents('./'.$page.'.php');","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":13,"col":17,"offset":345},"end":{"line":13,"col":22,"offset":350}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":13,"col":9,"offset":337},"end":{"line":13,"col":14,"offset":342}},"content":"$page"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":21,"col":28,"offset":550},"end":{"line":21,"col":45,"offset":567}},"'./'.$page.'.php'"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.file-inclusion","path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":24,"col":5,"offset":670},"end":{"line":24,"col":18,"offset":683},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":8,"offset":7},"abstract_content":"include"},"$FUNC":{"start":{"line":24,"col":5,"offset":670},"end":{"line":24,"col":12,"offset":677},"abstract_content":"include"},"$VAR":{"start":{"line":24,"col":5,"offset":670},"end":{"line":24,"col":18,"offset":683},"abstract_content":"include$page"}},"message":"Detected non-constant file inclusion. This can lead to local file inclusion (LFI) or remote file inclusion (RFI) if user input reaches this statement. LFI and RFI could lead to sensitive files being obtained by attackers. Instead, explicitly specify what to include. If that is not a viable solution, validate user input thoroughly.","metadata":{"cwe":["CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')"],"references":["https://www.php.net/manual/en/function.include.php","https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/EasyRFISniff.php","https://en.wikipedia.org/wiki/File_inclusion_vulnerability#Types_of_Inclusion"],"category":"security","technology":["php"],"owasp":["A03:2021 - Injection"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW"},"severity":"ERROR","fingerprint":"20c4fe90ad52134c1809ad09ee25b5b66929955b3b33c41b792f58a356f74d61b363213692f9fff1016eadb5dc57ac386f74d5edc670f47dbe5a6610f93b8c3e_0","lines":"    include($page);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":13,"col":17,"offset":345},"end":{"line":13,"col":22,"offset":350}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":13,"col":9,"offset":337},"end":{"line":13,"col":14,"offset":342}},"content":"$page"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","start":{"line":24,"col":5,"offset":670},"end":{"line":24,"col":18,"offset":683}},"include($page"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":24,"col":5,"offset":1193},"end":{"line":24,"col":47,"offset":1235},"extra":{"metavars":{"$...VARS":{"start":{"line":24,"col":10,"offset":1198},"end":{"line":24,"col":46,"offset":1234},"abstract_content":"file_get_contents('./'.$page.'.php')"}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities(file_get_contents('./'.$page.'.php'));","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"cc6a22024b345b62f21c6fc0f88f66bbab4c61e6bcdf72d0026bb79a6705f957765b82915de1d7015c94599b5a927f64765b2a07e406e5e3854c060a45911f22_0","lines":"    echo file_get_contents('./'.$page.'.php');","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":13,"col":17,"offset":345},"end":{"line":13,"col":22,"offset":350}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":13,"col":9,"offset":337},"end":{"line":13,"col":14,"offset":342}},"content":"$page"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":24,"col":5,"offset":1193},"end":{"line":24,"col":47,"offset":1235}},"echo file_get_contents('./'.$page.'.php');"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.tainted-filename","path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":24,"col":28,"offset":1216},"end":{"line":24,"col":45,"offset":1233},"extra":{"metavars":{"$FILENAME":{"start":{"line":24,"col":28,"offset":1216},"end":{"line":24,"col":45,"offset":1233},"abstract_content":"'./'.$page.'.php'"}},"message":"File name based on user input risks server-side request forgery.","metadata":{"technology":["php"],"category":"security","cwe":["CWE-918: Server-Side Request Forgery (SSRF)"],"owasp":["A10:2021 - Server-Side Request Forgery (SSRF)"],"references":["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"impact":"MEDIUM","likelihood":"MEDIUM","confidence":"MEDIUM"},"severity":"WARNING","fingerprint":"b0ed50b52d2639570da74b67e5325d7953b0e76ee785be6ad045f3c0100e6291c905f0d7c2fec4fc7e81e90376f573b75fc69b3962af277e08573965e295cfd5_0","lines":"    echo file_get_contents('./'.$page.'.php');","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":13,"col":17,"offset":345},"end":{"line":13,"col":22,"offset":350}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":13,"col":9,"offset":337},"end":{"line":13,"col":14,"offset":342}},"content":"$page"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":24,"col":28,"offset":1216},"end":{"line":24,"col":45,"offset":1233}},"'./'.$page.'.php'"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.file-inclusion","path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":25,"col":5,"offset":1241},"end":{"line":25,"col":18,"offset":1254},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":8,"offset":7},"abstract_content":"include"},"$FUNC":{"start":{"line":25,"col":5,"offset":1241},"end":{"line":25,"col":12,"offset":1248},"abstract_content":"include"},"$VAR":{"start":{"line":25,"col":5,"offset":1241},"end":{"line":25,"col":18,"offset":1254},"abstract_content":"include$page"}},"message":"Detected non-constant file inclusion. This can lead to local file inclusion (LFI) or remote file inclusion (RFI) if user input reaches this statement. LFI and RFI could lead to sensitive files being obtained by attackers. Instead, explicitly specify what to include. If that is not a viable solution, validate user input thoroughly.","metadata":{"cwe":["CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')"],"references":["https://www.php.net/manual/en/function.include.php","https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/EasyRFISniff.php","https://en.wikipedia.org/wiki/File_inclusion_vulnerability#Types_of_Inclusion"],"category":"security","technology":["php"],"owasp":["A03:2021 - Injection"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW"},"severity":"ERROR","fingerprint":"b4be478fdcbd104e7fe52f85c9f3e5d298fc13e08955d6718134bbac981fe504171d9f1b8e032aef5376054463775b1f8ee5d89f9e3018cdb69a180fcd928aff_0","lines":"    include($page);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":13,"col":17,"offset":345},"end":{"line":13,"col":22,"offset":350}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":13,"col":9,"offset":337},"end":{"line":13,"col":14,"offset":342}},"content":"$page"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","start":{"line":25,"col":5,"offset":1241},"end":{"line":25,"col":18,"offset":1254}},"include($page"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.file-inclusion","path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\whitelisting\\index.php","start":{"line":26,"col":13,"offset":844},"end":{"line":26,"col":26,"offset":857},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":8,"offset":7},"abstract_content":"include"},"$FUNC":{"start":{"line":26,"col":13,"offset":844},"end":{"line":26,"col":20,"offset":851},"abstract_content":"include"},"$VAR":{"start":{"line":26,"col":13,"offset":844},"end":{"line":26,"col":26,"offset":857},"abstract_content":"include$page"}},"message":"Detected non-constant file inclusion. This can lead to local file inclusion (LFI) or remote file inclusion (RFI) if user input reaches this statement. LFI and RFI could lead to sensitive files being obtained by attackers. Instead, explicitly specify what to include. If that is not a viable solution, validate user input thoroughly.","metadata":{"cwe":["CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')"],"references":["https://www.php.net/manual/en/function.include.php","https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/EasyRFISniff.php","https://en.wikipedia.org/wiki/File_inclusion_vulnerability#Types_of_Inclusion"],"category":"security","technology":["php"],"owasp":["A03:2021 - Injection"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW"},"severity":"ERROR","fingerprint":"3b4b6d03f6bfdd6baeccf7cc5fc7c5789b4550ffe9851b54d2fe9fa0ca2b6258a5637acceb8d5e30936c8b2ae2d2d066d1a7cd240f906689a2419cec39d91c74_0","lines":"            include($page);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\whitelisting\\index.php","start":{"line":24,"col":17,"offset":769},"end":{"line":24,"col":22,"offset":774}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\whitelisting\\index.php","start":{"line":24,"col":9,"offset":761},"end":{"line":24,"col":14,"offset":766}},"content":"$page"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\whitelisting\\index.php","start":{"line":26,"col":13,"offset":844},"end":{"line":26,"col":26,"offset":857}},"include($page"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.file-inclusion","path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\vulnerable\\index.php","start":{"line":15,"col":5,"offset":346},"end":{"line":15,"col":18,"offset":359},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":8,"offset":7},"abstract_content":"include"},"$FUNC":{"start":{"line":15,"col":5,"offset":346},"end":{"line":15,"col":12,"offset":353},"abstract_content":"include"},"$VAR":{"start":{"line":15,"col":5,"offset":346},"end":{"line":15,"col":18,"offset":359},"abstract_content":"include$page"}},"message":"Detected non-constant file inclusion. This can lead to local file inclusion (LFI) or remote file inclusion (RFI) if user input reaches this statement. LFI and RFI could lead to sensitive files being obtained by attackers. Instead, explicitly specify what to include. If that is not a viable solution, validate user input thoroughly.","metadata":{"cwe":["CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')"],"references":["https://www.php.net/manual/en/function.include.php","https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/EasyRFISniff.php","https://en.wikipedia.org/wiki/File_inclusion_vulnerability#Types_of_Inclusion"],"category":"security","technology":["php"],"owasp":["A03:2021 - Injection"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW"},"severity":"ERROR","fingerprint":"8c7af68fcd40fab9ad61d2c72260f93ace2abc6a4672a0b32d24ef27af9754135914b6fe0dd2674b98cf1d450d6e479c68dd5136e0035046f76a2fd7d21aa5b5_0","lines":"    include($page);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\vulnerable\\index.php","start":{"line":11,"col":17,"offset":276},"end":{"line":11,"col":22,"offset":281}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\vulnerable\\index.php","start":{"line":11,"col":9,"offset":268},"end":{"line":11,"col":14,"offset":273}},"content":"$page"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\LFI_RFI_DT_PT\\vulnerable\\index.php","start":{"line":15,"col":5,"offset":346},"end":{"line":15,"col":18,"offset":359}},"include($page"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.tainted-sql-string","path":"CodeAlpha_Task_3\\SQL_Injection\\vulnerable\\authentication.php","start":{"line":6,"col":16,"offset":140},"end":{"line":6,"col":92,"offset":216},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":7,"offset":6},"abstract_content":"select"},"$EXPR":{"start":{"line":6,"col":17,"offset":141},"end":{"line":6,"col":54,"offset":178},"abstract_content":"select *from login where username = '"}},"message":"User data flows into this manually-constructed SQL string. User data can be safely inserted into SQL strings using prepared statements or an object-relational mapper (ORM). Manually-constructed SQL strings is a possible indicator of SQL injection, which could let an attacker steal or manipulate data from the database. Instead, use prepared statements (`$mysqli->prepare(\"INSERT INTO test(id, label) VALUES (?, ?)\");`) or a safe library.","metadata":{"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://owasp.org/www-community/attacks/SQL_Injection"],"category":"security","technology":["php"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"f499e359e25834a5da2e91064fa7aae1f48f99ec0bfea4b75b2d028da7d9c1e35754a034ee92eadbd3b6794ef43a95929bd65cd8b75d2346e8523929c04e096f_0","lines":"        $sql = \"select *from login where username = '$username' and password = '$password'\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\SQL_Injection\\vulnerable\\authentication.php","start":{"line":3,"col":17,"offset":63},"end":{"line":3,"col":23,"offset":69}},"$_POST"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\SQL_Injection\\vulnerable\\authentication.php","start":{"line":3,"col":5,"offset":51},"end":{"line":3,"col":14,"offset":60}},"content":"$username"},{"location":{"path":"CodeAlpha_Task_3\\SQL_Injection\\vulnerable\\authentication.php","start":{"line":3,"col":5,"offset":51},"end":{"line":3,"col":14,"offset":60}},"content":"$username"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\SQL_Injection\\vulnerable\\authentication.php","start":{"line":6,"col":16,"offset":140},"end":{"line":6,"col":92,"offset":216}},"\"select *from login where username = '$username' and password = '$password'\""]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.php-ssrf","path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":3,"col":1,"offset":26},"end":{"line":4,"col":37,"offset":84},"extra":{"metavars":{"$VAR":{"start":{"line":3,"col":1,"offset":26},"end":{"line":3,"col":5,"offset":30},"abstract_content":"$url"},"$DATA":{"start":{"line":3,"col":8,"offset":33},"end":{"line":3,"col":20,"offset":45},"abstract_content":"$_GET['url']"},"$FUNCS":{"start":{"line":4,"col":13,"offset":60},"end":{"line":4,"col":30,"offset":77},"abstract_content":"file_get_contents"}},"message":"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination. Dangerous function file_get_contents with payload $_GET['url']","metadata":{"references":["https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"],"cwe":["CWE-918: Server-Side Request Forgery (SSRF)"],"category":"security","technology":["php"],"owasp":["A10:2021 - Server-Side Request Forgery (SSRF)"],"cwe2022-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW"},"severity":"ERROR","fingerprint":"ae6366362dc9e1fd61ecf4f19593af53462a716c19f119fd1772ba01b21957f80b47f2e44322bfe566f9b961915bb6d25949cb9f193a3b247622612507f8006f_0","lines":"$url = $_GET['url'];\n$response = file_get_contents($url);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.php-ssrf","path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":3,"col":1,"offset":26},"end":{"line":26,"col":2,"offset":1129},"extra":{"metavars":{"$VAR":{"start":{"line":3,"col":1,"offset":26},"end":{"line":3,"col":5,"offset":30},"abstract_content":"$url"},"$DATA":{"start":{"line":3,"col":8,"offset":33},"end":{"line":3,"col":20,"offset":45},"abstract_content":"$_GET['url']"},"$FUNCS":{"start":{"line":21,"col":17,"offset":900},"end":{"line":21,"col":34,"offset":917},"abstract_content":"file_get_contents"}},"message":"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination. Dangerous function file_get_contents with payload $_GET['url']","metadata":{"references":["https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"],"cwe":["CWE-918: Server-Side Request Forgery (SSRF)"],"category":"security","technology":["php"],"owasp":["A10:2021 - Server-Side Request Forgery (SSRF)"],"cwe2022-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW"},"severity":"ERROR","fingerprint":"ae6366362dc9e1fd61ecf4f19593af53462a716c19f119fd1772ba01b21957f80b47f2e44322bfe566f9b961915bb6d25949cb9f193a3b247622612507f8006f_1","lines":"$url = $_GET['url'];\n$response = file_get_contents($url);\necho $response;\n?>\n\nIn the above code, the URL is directly taken from the user input ($_GET['url']) without any validation or sanitization. An attacker can exploit this vulnerability by providing a malicious URL that can lead to SSRF attacks. For example, an attacker can pass the following URL to access internal resources or sensitive information:\n\nhttp://example.com/?url=http://chaitanyaeshwarprasad.com/file/something\n\n//Secured Code\n<?php\n$url = $_GET['url']; // Retrieve the URL parameter from the user input\n$allowed_hosts = ['example.com', 'api.example.com']; // List of allowed hosts\n\n$host = parse_url($url, PHP_URL_HOST); // Extract the host from the URL\n\nif (in_array($host, $allowed_hosts)) {\n    // If the extracted host is present in the allowed hosts list, proceed\n    $response = file_get_contents($url); // Fetch the contents of the URL\n    echo $response; // Display the response\n} else {\n    // If the extracted host is not in the allowed hosts list, display an error message\n    echo \"Invalid URL\";\n}","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.tainted-filename","path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":4,"col":31,"offset":78},"end":{"line":4,"col":35,"offset":82},"extra":{"metavars":{"$FILENAME":{"start":{"line":4,"col":31,"offset":78},"end":{"line":4,"col":35,"offset":82},"abstract_content":"$url","propagated_value":{"svalue_start":{"line":3,"col":8,"offset":33},"svalue_end":{"line":3,"col":20,"offset":45},"svalue_abstract_content":"$_GET['url']"}}},"message":"File name based on user input risks server-side request forgery.","metadata":{"technology":["php"],"category":"security","cwe":["CWE-918: Server-Side Request Forgery (SSRF)"],"owasp":["A10:2021 - Server-Side Request Forgery (SSRF)"],"references":["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"impact":"MEDIUM","likelihood":"MEDIUM","confidence":"MEDIUM"},"severity":"WARNING","fingerprint":"9dc13d41b099463a08406559ab1bc88271181089027089f4b0138279f67c2d972ffe6e53736dfc33cfeddf2ecd1e5379909e13d7c011acfd9ca44beb03246626_0","lines":"$response = file_get_contents($url);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":3,"col":8,"offset":33},"end":{"line":3,"col":13,"offset":38}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":3,"col":1,"offset":26},"end":{"line":3,"col":5,"offset":30}},"content":"$url"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":4,"col":31,"offset":78},"end":{"line":4,"col":35,"offset":82}},"$url"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":5,"col":1,"offset":86},"end":{"line":5,"col":16,"offset":101},"extra":{"metavars":{"$...VARS":{"start":{"line":5,"col":6,"offset":91},"end":{"line":5,"col":15,"offset":100},"abstract_content":"$response"}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities($response);","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"a6fd2b5ad6ee46f9193c89b0d466e50fc83fd1e2d4af2d4f0daa6501001a7b3143e35775f4b49fd13a652646aee58a5c0425f6920ace50876ace8c3d4906ef7a_0","lines":"echo $response;","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":3,"col":8,"offset":33},"end":{"line":3,"col":13,"offset":38}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":3,"col":1,"offset":26},"end":{"line":3,"col":5,"offset":30}},"content":"$url"},{"location":{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":4,"col":1,"offset":48},"end":{"line":4,"col":10,"offset":57}},"content":"$response"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":5,"col":1,"offset":86},"end":{"line":5,"col":16,"offset":101}},"echo $response;"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.php-ssrf","path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":14,"col":1,"offset":540},"end":{"line":26,"col":2,"offset":1129},"extra":{"metavars":{"$VAR":{"start":{"line":14,"col":1,"offset":540},"end":{"line":14,"col":5,"offset":544},"abstract_content":"$url"},"$DATA":{"start":{"line":14,"col":8,"offset":547},"end":{"line":14,"col":20,"offset":559},"abstract_content":"$_GET['url']"},"$FUNCS":{"start":{"line":21,"col":17,"offset":900},"end":{"line":21,"col":34,"offset":917},"abstract_content":"file_get_contents"}},"message":"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination. Dangerous function file_get_contents with payload $_GET['url']","metadata":{"references":["https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"],"cwe":["CWE-918: Server-Side Request Forgery (SSRF)"],"category":"security","technology":["php"],"owasp":["A10:2021 - Server-Side Request Forgery (SSRF)"],"cwe2022-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW"},"severity":"ERROR","fingerprint":"ae6366362dc9e1fd61ecf4f19593af53462a716c19f119fd1772ba01b21957f80b47f2e44322bfe566f9b961915bb6d25949cb9f193a3b247622612507f8006f_2","lines":"$url = $_GET['url']; // Retrieve the URL parameter from the user input\n$allowed_hosts = ['example.com', 'api.example.com']; // List of allowed hosts\n\n$host = parse_url($url, PHP_URL_HOST); // Extract the host from the URL\n\nif (in_array($host, $allowed_hosts)) {\n    // If the extracted host is present in the allowed hosts list, proceed\n    $response = file_get_contents($url); // Fetch the contents of the URL\n    echo $response; // Display the response\n} else {\n    // If the extracted host is not in the allowed hosts list, display an error message\n    echo \"Invalid URL\";\n}","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.tainted-filename","path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":21,"col":35,"offset":918},"end":{"line":21,"col":39,"offset":922},"extra":{"metavars":{"$FILENAME":{"start":{"line":21,"col":35,"offset":918},"end":{"line":21,"col":39,"offset":922},"abstract_content":"$url","propagated_value":{"svalue_start":{"line":14,"col":8,"offset":547},"svalue_end":{"line":14,"col":20,"offset":559},"svalue_abstract_content":"$_GET['url']"}}},"message":"File name based on user input risks server-side request forgery.","metadata":{"technology":["php"],"category":"security","cwe":["CWE-918: Server-Side Request Forgery (SSRF)"],"owasp":["A10:2021 - Server-Side Request Forgery (SSRF)"],"references":["https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"impact":"MEDIUM","likelihood":"MEDIUM","confidence":"MEDIUM"},"severity":"WARNING","fingerprint":"9dc13d41b099463a08406559ab1bc88271181089027089f4b0138279f67c2d972ffe6e53736dfc33cfeddf2ecd1e5379909e13d7c011acfd9ca44beb03246626_1","lines":"    $response = file_get_contents($url); // Fetch the contents of the URL","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":3,"col":8,"offset":33},"end":{"line":3,"col":13,"offset":38}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":3,"col":1,"offset":26},"end":{"line":3,"col":5,"offset":30}},"content":"$url"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":21,"col":35,"offset":918},"end":{"line":21,"col":39,"offset":922}},"$url"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.echoed-request","path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":22,"col":5,"offset":963},"end":{"line":22,"col":20,"offset":978},"extra":{"metavars":{"$...VARS":{"start":{"line":22,"col":10,"offset":968},"end":{"line":22,"col":19,"offset":977},"abstract_content":"$response"}},"message":"`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.","fix":"echo htmlentities($response);","metadata":{"technology":["php"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","references":["https://www.php.net/manual/en/function.htmlentities.php","https://www.php.net/manual/en/reserved.variables.request.php","https://www.php.net/manual/en/reserved.variables.post.php","https://www.php.net/manual/en/reserved.variables.get.php","https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"a6fd2b5ad6ee46f9193c89b0d466e50fc83fd1e2d4af2d4f0daa6501001a7b3143e35775f4b49fd13a652646aee58a5c0425f6920ace50876ace8c3d4906ef7a_1","lines":"    echo $response; // Display the response","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":3,"col":8,"offset":33},"end":{"line":3,"col":13,"offset":38}},"$_GET"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":3,"col":1,"offset":26},"end":{"line":3,"col":5,"offset":30}},"content":"$url"},{"location":{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":4,"col":1,"offset":48},"end":{"line":4,"col":10,"offset":57}},"content":"$response"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\SSRF\\SSRF.php","start":{"line":22,"col":5,"offset":963},"end":{"line":22,"col":20,"offset":978}},"echo $response;"]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.tainted-sql-string","path":"CodeAlpha_Task_3\\Secure_Passwords\\Insecure Passwords\\login_insecure.php","start":{"line":8,"col":12,"offset":165},"end":{"line":8,"col":62,"offset":215},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":7,"offset":6},"abstract_content":"SELECT"},"$EXPR":{"start":{"line":8,"col":13,"offset":166},"end":{"line":8,"col":51,"offset":204},"abstract_content":"SELECT * FROM users WHERE username = '"}},"message":"User data flows into this manually-constructed SQL string. User data can be safely inserted into SQL strings using prepared statements or an object-relational mapper (ORM). Manually-constructed SQL strings is a possible indicator of SQL injection, which could let an attacker steal or manipulate data from the database. Instead, use prepared statements (`$mysqli->prepare(\"INSERT INTO test(id, label) VALUES (?, ?)\");`) or a safe library.","metadata":{"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://owasp.org/www-community/attacks/SQL_Injection"],"category":"security","technology":["php"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"f4d8fd32fbc86ad12d2cde9d13e3ad69377e8611d41e98a778aa436d33e5fff3d8d97575b264f23a8837c394ff9b189ec35bc78ce09013d854ed8fce043e2233_0","lines":"    $sql = \"SELECT * FROM users WHERE username = '$username'\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\Secure_Passwords\\Insecure Passwords\\login_insecure.php","start":{"line":5,"col":17,"offset":94},"end":{"line":5,"col":23,"offset":100}},"$_POST"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\Secure_Passwords\\Insecure Passwords\\login_insecure.php","start":{"line":5,"col":5,"offset":82},"end":{"line":5,"col":14,"offset":91}},"content":"$username"},{"location":{"path":"CodeAlpha_Task_3\\Secure_Passwords\\Insecure Passwords\\login_insecure.php","start":{"line":5,"col":5,"offset":82},"end":{"line":5,"col":14,"offset":91}},"content":"$username"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\Secure_Passwords\\Insecure Passwords\\login_insecure.php","start":{"line":8,"col":12,"offset":165},"end":{"line":8,"col":62,"offset":215}},"\"SELECT * FROM users WHERE username = '$username'\""]]},"engine_kind":"OSS"}},{"check_id":"semgrep-rules.php.lang.security.injection.tainted-sql-string","path":"CodeAlpha_Task_3\\Secure_Passwords\\Secure Passwords\\login_secure.php","start":{"line":8,"col":12,"offset":165},"end":{"line":8,"col":62,"offset":215},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":7,"offset":6},"abstract_content":"SELECT"},"$EXPR":{"start":{"line":8,"col":13,"offset":166},"end":{"line":8,"col":51,"offset":204},"abstract_content":"SELECT * FROM users WHERE username = '"}},"message":"User data flows into this manually-constructed SQL string. User data can be safely inserted into SQL strings using prepared statements or an object-relational mapper (ORM). Manually-constructed SQL strings is a possible indicator of SQL injection, which could let an attacker steal or manipulate data from the database. Instead, use prepared statements (`$mysqli->prepare(\"INSERT INTO test(id, label) VALUES (?, ?)\");`) or a safe library.","metadata":{"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://owasp.org/www-community/attacks/SQL_Injection"],"category":"security","technology":["php"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM"},"severity":"ERROR","fingerprint":"3f1f6d9fd1fdfa65a2c2cbd5fa471abb5a2278e10ce956f268b4a75fd7eb0b4917e69a502440e3b7b25dd8a5408d8c3472c146e3bf099fb1cdebb2117a509aa4_0","lines":"    $sql = \"SELECT * FROM users WHERE username = '$username'\";","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"CodeAlpha_Task_3\\Secure_Passwords\\Secure Passwords\\login_secure.php","start":{"line":5,"col":17,"offset":94},"end":{"line":5,"col":23,"offset":100}},"$_POST"]],"intermediate_vars":[{"location":{"path":"CodeAlpha_Task_3\\Secure_Passwords\\Secure Passwords\\login_secure.php","start":{"line":5,"col":5,"offset":82},"end":{"line":5,"col":14,"offset":91}},"content":"$username"},{"location":{"path":"CodeAlpha_Task_3\\Secure_Passwords\\Secure Passwords\\login_secure.php","start":{"line":5,"col":5,"offset":82},"end":{"line":5,"col":14,"offset":91}},"content":"$username"}],"taint_sink":["CliLoc",[{"path":"CodeAlpha_Task_3\\Secure_Passwords\\Secure Passwords\\login_secure.php","start":{"line":8,"col":12,"offset":165},"end":{"line":8,"col":62,"offset":215}},"\"SELECT * FROM users WHERE username = '$username'\""]]},"engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["CodeAlpha_Task_3\\Cookie_Hijacking\\secured.php","CodeAlpha_Task_3\\Cookie_Hijacking\\vulnerable.php","CodeAlpha_Task_3\\CSRF\\secured.php","CodeAlpha_Task_3\\CSRF\\vulnerable.php","CodeAlpha_Task_3\\Error_Handling\\secured\\errorhandling.php","CodeAlpha_Task_3\\Error_Handling\\secured\\includeerror.php","CodeAlpha_Task_3\\Error_Handling\\secured\\logreporting.php","CodeAlpha_Task_3\\Error_Handling\\vulnerable.php","CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure.php","CodeAlpha_Task_3\\IDOR\\IDOR_Secure\\secure_frontend.php","CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable.php","CodeAlpha_Task_3\\IDOR\\IDOR_Vulnerable\\vulnerable_frontend.php","CodeAlpha_Task_3\\LDAP_Injection\\secured.php","CodeAlpha_Task_3\\LDAP_Injection\\vulnerable.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\about.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\contact.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\home.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\fullysecured\\index.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\about.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\contact.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\home.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\validation\\index.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\whitelisting\\about.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\whitelisting\\contact.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\whitelisting\\home.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\secured\\whitelisting\\index.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\vulnerable\\about.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\vulnerable\\contact.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\vulnerable\\home.php","CodeAlpha_Task_3\\LFI_RFI_DT_PT\\vulnerable\\index.php","CodeAlpha_Task_3\\Open_Redirection\\Open_Redirection.php","CodeAlpha_Task_3\\Secure_Passwords\\Insecure Passwords\\acepdb.php","CodeAlpha_Task_3\\Secure_Passwords\\Insecure Passwords\\login_insecure.php","CodeAlpha_Task_3\\Secure_Passwords\\Insecure Passwords\\register_insecure.php","CodeAlpha_Task_3\\Secure_Passwords\\Secure Passwords\\acepdb.php","CodeAlpha_Task_3\\Secure_Passwords\\Secure Passwords\\login_secure.php","CodeAlpha_Task_3\\Secure_Passwords\\Secure Passwords\\register_secure.php","CodeAlpha_Task_3\\Session_Hijacking\\secured\\index.php","CodeAlpha_Task_3\\Session_Hijacking\\secured\\logout.php","CodeAlpha_Task_3\\Session_Hijacking\\secured\\profile.php","CodeAlpha_Task_3\\Session_Hijacking\\secured\\register.php","CodeAlpha_Task_3\\Session_Hijacking\\vulnerable\\index.php","CodeAlpha_Task_3\\Session_Hijacking\\vulnerable\\logout.php","CodeAlpha_Task_3\\Session_Hijacking\\vulnerable\\profile.php","CodeAlpha_Task_3\\Session_Hijacking\\vulnerable\\register.php","CodeAlpha_Task_3\\SQL_Injection\\secured\\authentication.php","CodeAlpha_Task_3\\SQL_Injection\\secured\\connection.php","CodeAlpha_Task_3\\SQL_Injection\\vulnerable\\authentication.php","CodeAlpha_Task_3\\SQL_Injection\\vulnerable\\connection.php","CodeAlpha_Task_3\\SSRF\\SSRF.php","CodeAlpha_Task_3\\XSS\\secured.php","CodeAlpha_Task_3\\XSS\\Vulnerable.php"]},"time":{"rules":[],"rules_parse_time":0.21429681777954102,"profiling_times":{"config_time":5.785276412963867,"core_time":3.755535125732422,"ignores_time":0.0003402233123779297,"total_time":9.541830062866211},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":1.7577054500579834,"per_file_time":{"mean":0.033802027885730446,"std_dev":0.0005713994272418385},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9565217391304348,"rules_selected_ratio":0.11454849498327759,"rules_matched_ratio":0.11454849498327759},"targets":[],"total_bytes":0,"max_memory_bytes":144995520},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[]}