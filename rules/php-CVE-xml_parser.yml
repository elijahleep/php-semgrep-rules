rules:
  - id: php-xml-parse-dos
    languages: [php]
    severity: ERROR
    message: XML
    metadata:
      owasp: "A06:2021 â€“ Vulnerable and Outdated Components"
      project: VPCE(1)


    patterns:
      - patterns:
          - pattern: |
              xml_parse_into_struct(
                xml_parser_create_ns(...),
                str_repeat($STR, $COUNT),
                $OUT,
                ...
              )
          - metavariable-comparison:
              metavariable: $COUNT
              comparison: $COUNT >= 100
