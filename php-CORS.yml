rules:
  - id: php-permissive-cors-withheader
    message: The Access-Control-Allow-Origin header is set to "*", which enables requests from any origin. This results in permissive CORS configuration and may expose sensitive endpoints to cross-origin attacks.
    severity: WARNING
    languages: [php]
    metadata:
      owasp_top_10: "A05:2021 â€“ Security Misconfiguration"

    patterns:
      - pattern: $RESP->withHeader($NAME, $VALUE)
      - metavariable-regex:
          metavariable: $NAME
          regex: (\'|\")Access-Control-Allow-Origin(\'|\")
      - metavariable-regex:
          metavariable: $VALUE
          regex: (\'|\")\*(\'|\")